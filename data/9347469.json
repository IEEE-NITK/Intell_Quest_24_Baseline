{
    "abstract": "A Real-time electricity market transaction is an important method that is used to realize the interactive balance of source-network-load in a new generation power system. Based on the multi-camp economic choice and the needs of national conditions, the emergence of cluster operators is inevitable. Due to stability and development of photovoltaic users, it is important to evaluate the importance of...",
    "articleNumber": "9347469",
    "articleTitle": "Research on Cluster Economy Operation Model Considering Customer Satisfaction",
    "authors": [
        {
            "preferredName": "Wei Zhao",
            "normalizedName": "W. Zhao",
            "firstName": "Wei",
            "lastName": "Zhao",
            "searchablePreferredName": "Wei Zhao",
            "id": 37577627300
        },
        {
            "preferredName": "Wenqi Xue",
            "normalizedName": "W. Xue",
            "firstName": "Wenqi",
            "lastName": "Xue",
            "searchablePreferredName": "Wenqi Xue",
            "id": 37087410030
        },
        {
            "preferredName": "Peiqiang Li",
            "normalizedName": "P. Li",
            "firstName": "Peiqiang",
            "lastName": "Li",
            "searchablePreferredName": "Peiqiang Li",
            "id": 37673373300
        },
        {
            "preferredName": "Xuexian Tang",
            "normalizedName": "X. Tang",
            "firstName": "Xuexian",
            "lastName": "Tang",
            "searchablePreferredName": "Xuexian Tang",
            "id": 37088847706
        },
        {
            "preferredName": "Ertao Lei",
            "normalizedName": "E. Lei",
            "firstName": "Ertao",
            "lastName": "Lei",
            "searchablePreferredName": "Ertao Lei",
            "id": 37085784437
        },
        {
            "preferredName": "Hanbin Diao",
            "normalizedName": "H. Diao",
            "firstName": "Hanbin",
            "lastName": "Diao",
            "searchablePreferredName": "Hanbin Diao",
            "id": 37088529480
        },
        {
            "preferredName": "Xiaoxiu Lv",
            "normalizedName": "X. Lv",
            "firstName": "Xiaoxiu",
            "lastName": "Lv",
            "searchablePreferredName": "Xiaoxiu Lv",
            "id": 37088654016
        }
    ],
    "doi": "10.1109/ACCESS.2021.3057104",
    "publicationTitle": "IEEE Access",
    "publicationYear": "2022",
    "publicationVolume": null,
    "publicationIssue": null,
    "volume": "10",
    "issue": null,
    "documentLink": "/document/9347469/",
    "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<response><accessType>CCBY - IEEE is not the copyright holder of this material. Please follow the instructions via https://creativecommons.org/licenses/by/4.0/ to obtain full-text articles and stipulations in the API documentation.</accessType><div id=\"BodyWrapper\" class=\"ArticlePage\" xmlns:ieee=\"http://www.ieeexplore.ieee.org\"><div id=\"article\">\n<div class=\"section\" id=\"sec1\"><div class=\"header article-hdr\"><div class=\"kicker\">\n                                SECTION I.</div><h2>Introduction</h2></div><p>Photovoltaic power generation can effectively alleviate the current energy shortage and environmental pollution problems. Its major application is distributed household photovoltaic, which has advantages of being close to the user side, flexible in construction scale, simple in installation, and wide in application range. The implementation of policies and cost reductions has improved the development of power generation <a ref-type=\"bibr\" anchor=\"ref2\" id=\"context_ref_2_1\" data-range=\"ref2\">[2]</a>. Presently, the grid-connected power operation mode is \u201cself-use, surplus electricity access to the Internet\u201d <a ref-type=\"bibr\" anchor=\"ref3\" id=\"context_ref_3_1\" data-range=\"ref3\">[3]</a>. Most of the producers and sellers trade with the power grid in cluster mode, to gain more from the electricity utility <a ref-type=\"bibr\" anchor=\"ref4\" id=\"context_ref_4_1\" data-range=\"ref4\">[4]</a>. Based on China\u2019s national conditions and the state of the multi-party economy, it will be historically inevitable to construct operators that are within the electricity-selling market and the market structure regulations. It is therefore, necessary to execute the cluster economic operation model that is widely dominated by intermediate operators. This is to improve on market vitality.</p><p>The operation model of cluster economy has three elements: of pricing, benefit and ranking. Scholars have established several pricing strategies and benefit models. LIU <i>et al.</i> <a ref-type=\"bibr\" anchor=\"ref5\" id=\"context_ref_5_1\" data-range=\"ref5\">[5]</a> outlined a benefit-cost model of user participation in Demand Response (DR). LI <i>et al.</i> <a ref-type=\"bibr\" anchor=\"ref6\" id=\"context_ref_6_1\" data-range=\"ref6\">[6]</a> used fuzzy maximum satisfaction method, by applying the 1-n master-slave game to construct the user benefit function, the price response, and power supply pricing optimization of micro-grid. Referring to the domestic policy of household photovoltaic, Mary and others put forward a power cost model associated with the net load of the system, and then put forward a DR model for photovoltaic users based on game theory and proved that there is a unique Nash equilibrium strategy for this game problem <a ref-type=\"bibr\" anchor=\"ref4\" id=\"context_ref_4_1\" data-range=\"ref4\">[4]</a>, <a ref-type=\"bibr\" anchor=\"ref7\" id=\"context_ref_7_1\" data-range=\"ref7\">[7]</a>. Ma <i>et al.</i> <a ref-type=\"bibr\" anchor=\"ref8\" id=\"context_ref_8_1\" data-range=\"ref8\">[8]</a> outlined a game model between community operators and consumers using the master-slave game theory. The study, verified the advantages of improving the benefits of both parties and optimizing the load characteristics of the system. Tushar <i>et al.</i> <a ref-type=\"bibr\" anchor=\"ref9\" id=\"context_ref_9_1\" data-range=\"ref9\">[9]</a> applied the energy management scheme of wireless city, based on the non-cooperative Stackelberg game, which reduces the total operating cost of the community energy management center and improves the residential units with maximum distributed energy. Wang <i>et al.</i> <a ref-type=\"bibr\" anchor=\"ref10\" id=\"context_ref_10_1\" data-range=\"ref10\">[10]</a> and Liu <i>et al.</i> <a ref-type=\"bibr\" anchor=\"ref11\" id=\"context_ref_11_1\" data-range=\"ref11\">[11]</a> researched on the users\u2019 photovoltaic output power and electricity consumption, and found that it has an accurate prediction of at least one hour. The former puts forward a pricing model of photovoltaic users\u2019 group electricity price based on Stackelberg game. The latter continues to study the influence of user behavior on operators\u2019 revenue, and finally proposes an economic penalty model aiming at the difference between the actual output of photovoltaic power and the predicted value of load power. Ma <i>et al.</i> <a ref-type=\"bibr\" anchor=\"ref12\" id=\"context_ref_12_1\" data-range=\"ref12\">[12]</a> studied the joint operation mode of cogeneration and photovoltaic users, and proposed an internal pricing model of microgrid. Lin <i>et al.</i> <a ref-type=\"bibr\" anchor=\"ref13\" id=\"context_ref_13_1\" data-range=\"ref13\">[13]</a>, <a ref-type=\"bibr\" anchor=\"ref14\" id=\"context_ref_14_1\" data-range=\"ref14\">[14]</a> applied fuzzy double-objective method to normalize user\u2019s cost and dissatisfaction. However, literature <a ref-type=\"bibr\" anchor=\"ref13\" id=\"context_ref_13_1\" data-range=\"ref13\">[13]</a> used energy transaction model based on double Stackelberg game for power supply companies, micro-energy networks and users, while literature <a ref-type=\"bibr\" anchor=\"ref14\" id=\"context_ref_14_1\" data-range=\"ref14\">[14]</a> used an optimization model and solution method based on non-cooperative game for CCHP energy supply network. The daily electricity consumption of users mainly considers three factors: electricity utility, economy and satisfaction. User benefit model proposed <a ref-type=\"bibr\" anchor=\"ref5\" id=\"context_ref_5_1\" data-range=\"ref5\">[5]</a>, <a ref-type=\"bibr\" anchor=\"ref6\" id=\"context_ref_6_1\" data-range=\"ref6\">[6]</a>, <a ref-type=\"bibr\" anchor=\"ref13\" id=\"context_ref_13_1\" data-range=\"ref13 ref14 ref15\">[13]</a>\u2013\u200b<a ref-type=\"bibr\" anchor=\"ref15\" id=\"context_ref_15_1\" data-range=\"ref13 ref14 ref15\">[15]</a> does not consider the utility of electricity. Literature <a ref-type=\"bibr\" anchor=\"ref4\" id=\"context_ref_4_1\" data-range=\"ref4\">[4]</a>, <a ref-type=\"bibr\" anchor=\"ref7\" id=\"context_ref_7_1\" data-range=\"ref7 ref8 ref9 ref10 ref11 ref12\">[7]</a>\u2013\u200b<a ref-type=\"bibr\" anchor=\"ref12\" id=\"context_ref_12_1\" data-range=\"ref7 ref8 ref9 ref10 ref11 ref12\">[12]</a> did not consider the user\u2019s satisfaction with electricity consumption thus lacking its comprehension.</p><p>Several studies have focused on photovoltaic user groups on its economic operation, but limited on the evaluation of the importance of users in the group. However, to establish a stable and prosperous photovoltaic user group, it is necessary to solve the technical difficulties and the evaluation of user contribution <a ref-type=\"bibr\" anchor=\"ref16\" id=\"context_ref_16_1\" data-range=\"ref16\">[16]</a>. From the perspective of user group managers, it was found out that distinguishing significant users and giving incentives (usually economic rewards) is beneficial to the stability of the group. From the user\u2019s point of view, motivated users are likely to consume more electricity, thus, promoting the development and improvement of photovoltaic user groups. The PV (photovoltaic) user group has a reasonable importance evaluation and reward system, which will attract other PV users to join the group and make the PV user group grow and develop.</p><p>Therefore, this paper used the users\u2019 electricity consumption benefit model, that takes into account the utility, economy, and satisfaction retrieved from the user\u2019s point of view. For the photovoltaic users, the optimal operation of internal electricity price included: First, computing the contribution value of users in the group to operators\u2019 revenue. This was done by studying the revenue essence of group operators using, the cooperative game theory. Second, the evaluation index of users, operators, and power grid was defined, and the photovoltaic user group evaluated and ranked using the TOPSIS method. Finally, using the Stackelberg game, a 1-n electric energy trading model of \u201coperator-photovoltaic user group\u201d was constructed to complete the design of cluster economic operation.</p></div>\n<div class=\"section\" id=\"sec2\"><div class=\"header article-hdr\"><div class=\"kicker\">\n                                SECTION II.</div><h2>Cluster Operation Mode</h2></div><p>Photovoltaic user group is composed of users and cluster operators. Users are both producers and consumers. The transaction relationship and price setting are shown in <a ref-type=\"fig\" anchor=\"fig1\" class=\"fulltext-link\">Figure 1</a>.\n<div class=\"figure figure-full\" id=\"fig1\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9347469/xue1-3057104-large.gif\" data-fig-id=\"fig1\"><img src=\"\" data-src-img=\"/mediastore_new/IEEE/content/media/6287639/9668973/9347469/xue1-3057104-small.gif\" alt=\"FIGURE 1. - Cluster trading mechanism framework.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 1. </b><fig><p>Cluster trading mechanism framework.</p></fig></div><p class=\"links\"><a href=\"/document/9347469/figures\" class=\"all\">Show All</a></p></div></p><p class=\"has-inline-formula\">The cluster operator formulates the cluster tariff <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$p_{s}$\n</tex-math></inline-formula> and <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$p_{b}, \\lambda _{b}$\n</tex-math></inline-formula> and <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$\\lambda _{s}$\n</tex-math></inline-formula>.It uses <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$p_{s}$\n</tex-math></inline-formula> to acquire the surplus energy of surplus power users, and uses <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$p_{b}$\n</tex-math></inline-formula> to sell energy to the consumers who are short of electricity. If the overall power consumption of the cluster is greater than its photovoltaic capacity, the cluster operator will purchase the power of the large grid with <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$\\lambda _{b}$\n</tex-math></inline-formula>, and the cluster operator will purchase power from the large grid with <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$\\lambda _{s}$\n</tex-math></inline-formula> if the overall power consumption of the cluster is greater than its photovoltaic capacity. In this process, it maximizes its own income through price difference. Therefore, <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$p_{s}$\n</tex-math></inline-formula> is not lower than the grid price <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$\\lambda _{s}$\n</tex-math></inline-formula>, and <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$p_{b}$\n</tex-math></inline-formula> is not greater than the grid price <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$\\lambda _{b}$\n</tex-math></inline-formula>.</p><p class=\"has-inline-formula\">Users follow the cluster operator and respond to the demand according to the electricity price to maximize their own electricity use efficiency. All electric energy transactions in the cluster are realized by cluster operator. A day is divided into <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$m$\n</tex-math></inline-formula> periods on average to form period set <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$I=\\{1,2,3\\ldots m\\}$\n</tex-math></inline-formula>. The number of users constitutes the PV user group set <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$NP=\\{1,2,3\\ldots N\\}$\n</tex-math></inline-formula>. In the <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$i$\n</tex-math></inline-formula> period, the cluster price set by the cluster operator is <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$p_{si}$\n</tex-math></inline-formula> and <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$p_{bi..}$\n</tex-math></inline-formula> When user n trades with the grid separately, the energy consumed by user <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$n$\n</tex-math></inline-formula> is <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$x_{ni}$\n</tex-math></inline-formula>, which is also known as the original planned electricity consumption. The actual energy consumed in the photovoltaic user group is <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$x_{ani}$\n</tex-math></inline-formula>, and the energy generated by the photovoltaic system is <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$e_{ni}$\n</tex-math></inline-formula>, then the amount of electricity the user needs to trade with the cluster operator is <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$e_{ni-}x_{ani}$\n</tex-math></inline-formula>. When <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$e_{ni-}x_{ani}&gt; 0$\n</tex-math></inline-formula>, user n needs to sell electricity to cluster operator; when <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$e_{ni-}x_{ani}&lt; 0$\n</tex-math></inline-formula>, user n needs to purchase electricity from cluster operator. Therefore, it is not necessary for users to participate in the transaction. According to the purchase and sale behaviors of consumers and power grid at that time, all users are divided into power purchase users and power sales users <a ref-type=\"bibr\" anchor=\"ref11\" id=\"context_ref_11_2\" data-range=\"ref11\">[11]</a>.</p><div class=\"section_2\" id=\"sec2a\"><h3>A. Customer Satisfaction Model</h3><p class=\"has-inline-formula\">In the existing literature, the difference between the actual power consumption and the original planned power consumption is used as a function of power consumption comfort or satisfaction <a ref-type=\"bibr\" anchor=\"ref5\" id=\"context_ref_5_2a\" data-range=\"ref5\">[5]</a>, <a ref-type=\"bibr\" anchor=\"ref6\" id=\"context_ref_6_2a\" data-range=\"ref6\">[6]</a>, <a ref-type=\"bibr\" anchor=\"ref13\" id=\"context_ref_13_2a\" data-range=\"ref13 ref14 ref15\">[13]</a>\u2013\u200b<a ref-type=\"bibr\" anchor=\"ref15\" id=\"context_ref_15_2a\" data-range=\"ref13 ref14 ref15\">[15]</a>. When the actual consumption of electricity is less than the original plan, the satisfaction function of electricity consumption is negative, otherwise, the reproduction is positive. Equal is zero. For PV users <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$n$\n</tex-math></inline-formula>, the power consumption satisfaction function <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$S_{ni}(x_{ani},x_{ni})$\n</tex-math></inline-formula> has the following characteristics:\n<ol><li value=\"1\" data-list-item-label=\"(1)\"><p class=\"has-inline-formula\">If the actual power consumption <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$x_{ani}$\n</tex-math></inline-formula> is less than the planned power consumption <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$x_{ni}$\n</tex-math></inline-formula>, that is <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$x_{ani}&lt; x_{nii}$\n</tex-math></inline-formula>, the power consumption satisfaction value is negative, which indicates that the power consumption satisfaction of consumers decreases, and the function value decreases rapidly with the decrease of actual power consumption:<disp-formula id=\"deqn1\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} S_{ni} (x_{ani},x_{ni})&lt; 0,\\frac {\\partial S_{ni}}{\\partial x_{ani}}&gt;0,\\frac {\\partial ^{2}S_{ni}}{\\partial x_{ani}^{2}}&lt; 0\\tag{1}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} S_{ni} (x_{ani},x_{ni})&lt; 0,\\frac {\\partial S_{ni}}{\\partial x_{ani}}&gt;0,\\frac {\\partial ^{2}S_{ni}}{\\partial x_{ani}^{2}}&lt; 0\\tag{1}\\end{equation*}\n</span></span></disp-formula></p></li><li value=\"2\" data-list-item-label=\"(2)\"><p class=\"has-inline-formula\">When the actual electricity consumption is equal to the planned power consumption, that is <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$x_{ani}=x_{ni}$\n</tex-math></inline-formula>, the satisfaction function of electricity consumption is <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$S_{ni}(x_{ani},x_{ni})=0$\n</tex-math></inline-formula>.</p></li><li value=\"3\" data-list-item-label=\"(3)\"><p class=\"has-inline-formula\">If the actual power consumption is greater than the planned power consumption, that is <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$x_{ani}&gt;x_{ni}$\n</tex-math></inline-formula>, the power consumption satisfaction value is positive, which indicates that the power consumption satisfaction of consumers increases. The function value increases slowly with the increase of actual power consumption, and the increase speed decreases gradually:<disp-formula id=\"deqn2\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} S_{ni} (x_{ani},x_{ni})&gt;0,\\frac {\\partial S_{ni}}{\\partial x_{ani}}&gt;0,\\frac {\\partial ^{2}S_{ni}}{\\partial x_{ani}^{2}}&lt; 0\\tag{2}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} S_{ni} (x_{ani},x_{ni})&gt;0,\\frac {\\partial S_{ni}}{\\partial x_{ani}}&gt;0,\\frac {\\partial ^{2}S_{ni}}{\\partial x_{ani}^{2}}&lt; 0\\tag{2}\\end{equation*}\n</span></span></disp-formula> In this paper, the power consumption satisfaction model of PV user <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$n$\n</tex-math></inline-formula> in the <i>i-th</i> period is as follows.<disp-formula id=\"deqn3\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} S_{\\textrm {ni}} (x_{ani},x_{ni})=\\beta _{\\textrm {ni}} x_{ni} \\left [{ {\\left({\\frac {x_{ani}}{x_{ni}}}\\right)^{\\alpha _{ni}}-1} }\\right]\\tag{3}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} S_{\\textrm {ni}} (x_{ani},x_{ni})=\\beta _{\\textrm {ni}} x_{ni} \\left [{ {\\left({\\frac {x_{ani}}{x_{ni}}}\\right)^{\\alpha _{ni}}-1} }\\right]\\tag{3}\\end{equation*}\n</span></span></disp-formula></p></li></ol></p><p class=\"has-inline-formula\">In formula, <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$\\alpha _{ni}$\n</tex-math></inline-formula> and <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$\\beta _{ni}$\n</tex-math></inline-formula> are the satisfaction parameters of user <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$n$\n</tex-math></inline-formula> in <i>i-th</i> period, <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$\\alpha _{ni}&lt; 0$\n</tex-math></inline-formula> and <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$\\beta _{ni}&lt; 0$\n</tex-math></inline-formula>, and the requirements of different types of users for electricity consumption satisfaction can be described by adjusting <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$\\alpha _{ni}$\n</tex-math></inline-formula> and <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$\\beta _{ni}$\n</tex-math></inline-formula>. Let the planned power consumption of user <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$n$\n</tex-math></inline-formula> in the <i>i-th</i> period be <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$x_{ni}=100\\,\\,\\text {kW}.\\text {h}$\n</tex-math></inline-formula>, and by adjusting the actual power consumption <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$x_{ani}$\n</tex-math></inline-formula>, the user satisfaction function under different parameter values is shown in <a ref-type=\"fig\" anchor=\"fig2\" class=\"fulltext-link\">Figure 2</a>.\n<div class=\"figure figure-full\" id=\"fig2\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9347469/xue2-3057104-large.gif\" data-fig-id=\"fig2\"><img src=\"\" data-src-img=\"/mediastore_new/IEEE/content/media/6287639/9668973/9347469/xue2-3057104-small.gif\" alt=\"FIGURE 2. - User satisfaction function with different parameters.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 2. </b><fig><p>User satisfaction function with different parameters.</p></fig></div><p class=\"links\"><a href=\"/document/9347469/figures\" class=\"all\">Show All</a></p></div></p></div><div class=\"section_2\" id=\"sec2b\"><h3>B. Power Consumption Benefit Of Photovoltaic Users</h3><p class=\"has-inline-formula\">The use of logarithmic function to describe the utility of electricity consumption <a ref-type=\"bibr\" anchor=\"ref8\" id=\"context_ref_8_2b\" data-range=\"ref8 ref9 ref10 ref11 ref12\">[8]</a>\u2013\u200b<a ref-type=\"bibr\" anchor=\"ref12\" id=\"context_ref_12_2b\" data-range=\"ref8 ref9 ref10 ref11 ref12\">[12]</a>, <a ref-type=\"bibr\" anchor=\"ref17\" id=\"context_ref_17_2b\" data-range=\"ref17 ref18 ref19\">[17]</a>\u2013\u200b<a ref-type=\"bibr\" anchor=\"ref19\" id=\"context_ref_19_2b\" data-range=\"ref17 ref18 ref19\">[19]</a> has achieved positive results. The overall electricity consumption benefit of users is composed of the utility of prosumers and the electricity transaction cost. The cluster operator makes the maximum profit by setting the cluster price, and users respond to the demand according to the cluster price. In the existing power consumption benefit model <a ref-type=\"bibr\" anchor=\"ref14\" id=\"context_ref_14_2b\" data-range=\"ref14 ref15 ref16 ref17\">[14]</a>\u2013\u200b<a ref-type=\"bibr\" anchor=\"ref17\" id=\"context_ref_17_2b\" data-range=\"ref14 ref15 ref16 ref17\">[17]</a>, the sensitivity of user power consumption adjustment to cluster electricity price is too high, which will lead to excessive adjustment rate of user power consumption. This new function is used to solve the problem of user satisfaction.<disp-formula id=\"deqn4\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*} U_{ni} =\\begin{cases} {K_{ni} \\ln (1+x_{ani})+p_{si} (E_{gni} -x_{ani})} \\\\ {+\\beta _{\\textrm {ni}} x_{ni} \\left [{ {\\left({\\frac {x_{ani}}{x_{ni}}}\\right)^{\\alpha _{ni}}-1} }\\right],E_{ni} -x_{ni} &gt;0} \\\\ {K_{ni} \\ln (1+x_{ani})+p_{bi} (E_{ni} -x_{ani})} \\\\ {+\\beta _{\\textrm {ni}} x_{ni} \\left [{ {\\left({\\frac {x_{ani}}{x_{ni}}}\\right)^{\\alpha _{ni}}-1} }\\right],E_{ni} -x_{ni} &lt; 0} \\end{cases}\\tag{4}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*} U_{ni} =\\begin{cases} {K_{ni} \\ln (1+x_{ani})+p_{si} (E_{gni} -x_{ani})} \\\\ {+\\beta _{\\textrm {ni}} x_{ni} \\left [{ {\\left({\\frac {x_{ani}}{x_{ni}}}\\right)^{\\alpha _{ni}}-1} }\\right],E_{ni} -x_{ni} &gt;0} \\\\ {K_{ni} \\ln (1+x_{ani})+p_{bi} (E_{ni} -x_{ani})} \\\\ {+\\beta _{\\textrm {ni}} x_{ni} \\left [{ {\\left({\\frac {x_{ani}}{x_{ni}}}\\right)^{\\alpha _{ni}}-1} }\\right],E_{ni} -x_{ni} &lt; 0} \\end{cases}\\tag{4}\\end{align*}\n</span></span></disp-formula> In the formula: <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$U_{ni}$\n</tex-math></inline-formula>\u2014the overall electricity consumption benefit of user <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$n$\n</tex-math></inline-formula> in the <i>i-th</i> period; <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$K_{ni}$\n</tex-math></inline-formula>\u2014 Utility coefficient, whose value is related to user demand and time period. It can be seen from formula <a ref-type=\"disp-formula\" anchor=\"deqn4\" href=\"#deqn4\" class=\"fulltext-link\">(4)</a> that when the actual electricity consumption <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$x_{ani}$\n</tex-math></inline-formula> increases, the electricity utility and satisfaction of electricity sales users increase, and the electricity sales income decreases; the electricity consumption utility and satisfaction of power consumers also increase, and the electricity purchase cost increases and shows a negative decrease. The actual power consumption <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$x_{ani}$\n</tex-math></inline-formula> is determined by balancing the electricity sales revenue or purchase cost, customer satisfaction and electricity utility, so as to maximize the overall power consumption benefit. The first derivative of benefit function <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$U_{ni}^{\\prime }(x_{ani})$\n</tex-math></inline-formula> is as follows.<disp-formula id=\"deqn5\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*}&amp;\\hspace {-0.5pc} \\frac {\\partial U_{ni}}{\\partial x_{ani}} \\\\&amp;= \\begin{cases} {\\frac {K_{ni}}{1+x_{ani}}-p_{si} +\\alpha _{ni} \\beta _{ni} \\left({\\frac {x_{ani}}{x_{ni}}}\\right)^{\\alpha _{ni} -1}} &amp; {E_{ni} -x_{ni} &gt;0} \\\\ {\\frac {K_{ni}}{1+x_{ani}}-p_{bi} +\\alpha _{ni} \\beta _{ni} \\left({\\frac {x_{ani}}{x_{ni}}}\\right)^{\\alpha _{ni} -1}} &amp; {E_{ni} -x_{ni} &lt; 0} \\end{cases} \\\\ {}\\tag{5}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*}&amp;\\hspace {-0.5pc} \\frac {\\partial U_{ni}}{\\partial x_{ani}} \\\\&amp;= \\begin{cases} {\\frac {K_{ni}}{1+x_{ani}}-p_{si} +\\alpha _{ni} \\beta _{ni} \\left({\\frac {x_{ani}}{x_{ni}}}\\right)^{\\alpha _{ni} -1}} &amp; {E_{ni} -x_{ni} &gt;0} \\\\ {\\frac {K_{ni}}{1+x_{ani}}-p_{bi} +\\alpha _{ni} \\beta _{ni} \\left({\\frac {x_{ani}}{x_{ni}}}\\right)^{\\alpha _{ni} -1}} &amp; {E_{ni} -x_{ni} &lt; 0} \\end{cases} \\\\ {}\\tag{5}\\end{align*}\n</span></span></disp-formula> By continuing to derive the user benefit function with respect to the actual electricity consumption <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$x_{ani}$\n</tex-math></inline-formula>, the second derivative a of the benefit function <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">${U_{ni}}^{\\prime \\prime }(x_{ani})$\n</tex-math></inline-formula> can be obtained as follows.<disp-formula id=\"deqn6\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} \\frac {\\partial ^{2}U_{ni}}{\\partial x_{ani}^{2}}=-\\frac {K_{ni}}{(1+x_{ani})^{2}}+\\alpha _{ni} \\beta _{ni} (\\alpha _{ni} -1)\\frac {x_{ani}^{\\alpha _{ni} -2}}{x_{n}^{\\alpha _{ni} -1}}\\tag{6}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} \\frac {\\partial ^{2}U_{ni}}{\\partial x_{ani}^{2}}=-\\frac {K_{ni}}{(1+x_{ani})^{2}}+\\alpha _{ni} \\beta _{ni} (\\alpha _{ni} -1)\\frac {x_{ani}^{\\alpha _{ni} -2}}{x_{n}^{\\alpha _{ni} -1}}\\tag{6}\\end{equation*}\n</span></span></disp-formula> In this formula, <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$K_{ni}&gt;0$\n</tex-math></inline-formula>, <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$\\alpha _{ni}\\beta _{ni}&gt;0$\n</tex-math></inline-formula> and <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$\\alpha _{ni}-1&lt; 0$\n</tex-math></inline-formula>, so <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">${U_{ni}}^{\\prime \\prime }(x_{ani})&lt; 0$\n</tex-math></inline-formula>, thus the benefit function <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$U_{ni}$\n</tex-math></inline-formula> is a strictly convex function about <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$x_{ani}$\n</tex-math></inline-formula>. For the maximum benefit <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$U_{nio}$\n</tex-math></inline-formula> of user <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$n$\n</tex-math></inline-formula> in the <i>i-th</i> period, the optimal power consumption <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$x_{anio}$\n</tex-math></inline-formula> is unique.</p><p class=\"has-inline-formula\">Suppose that when the cluster electricity price <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$p_{si}=\\lambda _{s}, p_{bi}=\\lambda $\n</tex-math></inline-formula>, the photovoltaic users use electricity according to the original plan, that is, <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$x_{ani}=x_{nii}$\n</tex-math></inline-formula>, and the benefit is the most. When <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">${U_{ni}}^{\\prime }(x_{ani}\\it)=0$\n</tex-math></inline-formula>, the utility coefficient <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$K_{ni}$\n</tex-math></inline-formula> can be obtained by calculation <disp-formula id=\"deqn7\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*} K_{ni} =\\begin{cases} {(\\lambda _{s} -\\alpha _{ni} \\beta _{ni})(1+x_{ni})}&amp; {E_{ni} -x_{ni} &gt;0} \\\\ {(\\lambda _{b} -\\alpha _{ni} \\beta _{ni})(1+x_{ni})} &amp; {E_{ni} -x_{ni} &lt; 0}\\\\ \\end{cases}\\tag{7}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*} K_{ni} =\\begin{cases} {(\\lambda _{s} -\\alpha _{ni} \\beta _{ni})(1+x_{ni})}&amp; {E_{ni} -x_{ni} &gt;0} \\\\ {(\\lambda _{b} -\\alpha _{ni} \\beta _{ni})(1+x_{ni})} &amp; {E_{ni} -x_{ni} &lt; 0}\\\\ \\end{cases}\\tag{7}\\end{align*}\n</span></span></disp-formula> In which <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$0&lt; \\alpha _{ni}\\beta _{ni}&lt; \\lambda _{s}&lt; \\lambda _{b}, K_{ni}$\n</tex-math></inline-formula> is a positive value. When <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$E_{ni}-x_{ani}\\ne 0$\n</tex-math></inline-formula>, the cluster electricity price formulated by CO is <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$p_{si} $\n</tex-math></inline-formula> and <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$p_{bi}$\n</tex-math></inline-formula>, and other parameters are known, so that <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">${U_{ni}}^{\\prime }(x_{ani})=0$\n</tex-math></inline-formula>. The theoretical optimal electricity consumption <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$x_{nio}$\n</tex-math></inline-formula> of user <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$n$\n</tex-math></inline-formula> in the <i>i-th</i> period can be obtained by using fzero function in MATLAB.</p><p class=\"has-inline-formula\"><div class=\"section_2\" id=\"theorem1\"><h4 class=\"statement theorem run-in\">Theorem 1:</h4><p class=\"has-inline-formula\">In the i-th period, the role of purchasing and selling electricity in the cluster of photovoltaic users is determined by the net power under the initial situation. When the power price <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$p_{si}$\n</tex-math></inline-formula> and <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$p_{bi}$\n</tex-math></inline-formula> set by the operators meet the conditions of <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$\\lambda _{s}&lt; p_{si}&lt; p_{bi}&lt; \\lambda _{b}$\n</tex-math></inline-formula>, the users will not change their roles and their benefits will increase <a ref-type=\"bibr\" anchor=\"ref16\" id=\"context_ref_16_2b\" data-range=\"ref16\">[16]</a>.</p></div></p><p class=\"has-inline-formula\">The proof is as follows:\n<ol><li value=\"1\" data-list-item-label=\"(1)\"><p class=\"has-inline-formula\">For electricity consumers, <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$E_{ni-}x_{ni}&gt;0$\n</tex-math></inline-formula>. When the price of internal electricity sales is <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$p_{si}$\n</tex-math></inline-formula>, then the user\u2019s electricity consumption benefit function <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$U_{ni}$\n</tex-math></inline-formula> and its first derivative <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$U_{ni}^{\\prime }(x_{ani})$\n</tex-math></inline-formula> are as follows.<disp-formula id=\"deqn8-deqn9\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*} U_{ni}=&amp;K_{ni} \\ln (1+x_{ani})+p_{si} (E_{ni} -x_{ani}) \\\\&amp;+\\beta _{\\textrm {ni}} x_{ni}\\left [{ {\\begin{matrix} {\\left({\\frac {x_{ani}}{x_{ni}}}\\right)^{\\alpha _{ni}}-1} \\end{matrix}} }\\right] \\tag{8}\\\\ U_{ni}=&amp;K_{ni} \\ln (1+x_{ani})+p_{si} (E_{ni} -x_{ani}) \\\\&amp;+ \\beta _{\\textrm {ni}} x_{ni} \\left [{ {\\begin{matrix} {\\left({\\frac {x_{ani}}{x_{ni}}}\\right)^{\\alpha _{ni}}-1} \\end{matrix}} }\\right]\\tag{9}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*} U_{ni}=&amp;K_{ni} \\ln (1+x_{ani})+p_{si} (E_{ni} -x_{ani}) \\\\&amp;+\\beta _{\\textrm {ni}} x_{ni}\\left [{ {\\begin{matrix} {\\left({\\frac {x_{ani}}{x_{ni}}}\\right)^{\\alpha _{ni}}-1} \\end{matrix}} }\\right] \\tag{8}\\\\ U_{ni}=&amp;K_{ni} \\ln (1+x_{ani})+p_{si} (E_{ni} -x_{ani}) \\\\&amp;+ \\beta _{\\textrm {ni}} x_{ni} \\left [{ {\\begin{matrix} {\\left({\\frac {x_{ani}}{x_{ni}}}\\right)^{\\alpha _{ni}}-1} \\end{matrix}} }\\right]\\tag{9}\\end{align*}\n</span></span></disp-formula> When <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$x_{ani}=x_{ni}$\n</tex-math></inline-formula>, <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">${U_{ni}}^{\\prime }(x_{ani})=\\lambda _{s}-p_{si}&lt; 0$\n</tex-math></inline-formula>, and <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">${U_{ni}}^{\\prime \\prime }(x_{ani})&lt; 0$\n</tex-math></inline-formula>, the derivative of utility function <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">${U_{ni}}^{\\prime }(x_{ani})$\n</tex-math></inline-formula> is a decreasing function of <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$x_{ani}$\n</tex-math></inline-formula>, so <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$x_{nio}&lt; x_{ni}$\n</tex-math></inline-formula> makes <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$U_{ni}^{\\prime }(x_{nio})=0$\n</tex-math></inline-formula>, and the benefit of users is maximum. Therefore, the user\u2019s role in selling electricity does not change and the amount of electricity sold increases.</p><p class=\"has-inline-formula\">When the electricity-selling user trades with the power grid at the price <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$\\lambda _{s}$\n</tex-math></inline-formula> and the electricity consumption of the user is <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$x_{ni}$\n</tex-math></inline-formula>, the benefit function of the user reaches the maximum. According to formula <a ref-type=\"disp-formula\" anchor=\"deqn4\" href=\"#deqn4\" class=\"fulltext-link\">(4)</a>, the value of the benefit function at this time is:<disp-formula id=\"deqn10\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} U_{ni} (\\lambda _{s},x_{ni})=K_{ni} \\ln (1+x_{ni})+\\lambda _{s} (E_{ni} -x_{ni})\\tag{10}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} U_{ni} (\\lambda _{s},x_{ni})=K_{ni} \\ln (1+x_{ni})+\\lambda _{s} (E_{ni} -x_{ni})\\tag{10}\\end{equation*}\n</span></span></disp-formula> When the electricity selling consumers trade with the operator CO at the cluster price <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$p_{si}$\n</tex-math></inline-formula>, assuming that the actual electricity consumption <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$x_{ani}=x_{ni}$\n</tex-math></inline-formula>, according to formula <a ref-type=\"disp-formula\" anchor=\"deqn4\" href=\"#deqn4\" class=\"fulltext-link\">(4)</a>, the value of benefit function of power selling users is as follows.<disp-formula id=\"deqn11\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} U_{ni} (p_{si},x_{ni})=K_{ni} \\ln (1+x_{ni})+p_{si} (E_{ni} -x_{ni})\\tag{11}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} U_{ni} (p_{si},x_{ni})=K_{ni} \\ln (1+x_{ni})+p_{si} (E_{ni} -x_{ni})\\tag{11}\\end{equation*}\n</span></span></disp-formula> It is known that <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$p_{si}&gt;\\lambda _{s}, K_{ni}&gt;0$\n</tex-math></inline-formula>, and by comparing <a ref-type=\"disp-formula\" anchor=\"deqn10\" href=\"#deqn10\" class=\"fulltext-link\">equation (10)</a> with <a ref-type=\"disp-formula\" anchor=\"deqn11\" href=\"#deqn11\" class=\"fulltext-link\">equation (11)</a>, we can know that <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$U_{ni}(p_{si},x_{ni})&gt;U_{ni}(\\lambda _{s},x_{n_{\\mathrm {i}}})$\n</tex-math></inline-formula>. And because <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$U_{ni}^{\\prime }(x_{ni})=\\lambda _{s}-p_{si}&lt; 0, x_{ani}=x_{ni}$\n</tex-math></inline-formula> is not the optimal power consumption under the cluster electricity price <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$p_{si}$\n</tex-math></inline-formula>. According to the foregoing, it can be known that there is an optimal electricity consumption <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$x_{nio}$\n</tex-math></inline-formula> which makes <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$U_{ni}^{\\prime }(x_{nio})=0$\n</tex-math></inline-formula> and <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$U_{ni}(p_{si}{\\it,x}_{nio})&gt;U_{ni}(p_{si}{\\it,x}_{ni})$\n</tex-math></inline-formula>, so <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$U_{ni}(p_{si}{\\it,x}_{nio})&gt;U_{ni}(\\lambda _{s}{\\it,x}_{n_{\\mathrm {i}}})$\n</tex-math></inline-formula> means that the benefits will increase after the sales users trade with operators.</p><p class=\"has-inline-formula\">When the optimal power consumption satisfies the condition <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$x_{ni(min)}\\le x_{nio}\\le x_{ni}(max)$\n</tex-math></inline-formula>, the optimal power consumption of users is <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$x_{anio}=x_{nio}$\n</tex-math></inline-formula>. When the solution does not satisfy the condition <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$x_{ni(min)}\\le x_{nio}\\le x_{ni(max)}$\n</tex-math></inline-formula>, that is, <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$x_{nio}&lt; x_{ni(min)}$\n</tex-math></inline-formula>, because <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">${U_{ni}}^{\\prime }(x_{nio})=0, {U_{ni}}^{\\prime }(x_{ni})=\\lambda _{s}- p_{si}&lt; 0, x_{nio}&lt; x_{ni}$\n</tex-math></inline-formula>, the power consumption benefit of users decreases in the interval <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$[x_{nio},x_{ni}]$\n</tex-math></inline-formula>. In addition, because <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$x_{nio}&lt; x_{ni(min)}&lt; x_{ni}$\n</tex-math></inline-formula>, <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$x_{anio}=x_{ni_{(}min)}$\n</tex-math></inline-formula> is adopted at this time, which can maximize the power utilization benefit of users under the condition of satisfying the power consumption restriction.</p></li><li value=\"2\" data-list-item-label=\"(2)\"><p class=\"has-inline-formula\">In the same way, the power consumers will not change their role in purchasing electricity, and with the increase of purchasing power, the benefits of users will increase. When the power consumption restriction condition is satisfied, <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$x_{anio}=x_{nio}$\n</tex-math></inline-formula>; but when it is not satisfied, that is, <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$x_{nio}&gt;x_{ni(max)}$\n</tex-math></inline-formula>, then <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$x_{anio}=x_{ni(max)}$\n</tex-math></inline-formula>. The proof is over. In order to study the relationship between the overall electricity use efficiency and the cluster electricity price. Suppose that the electricity consumption <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$x_{sn}=130, E_{sn}^{g}=150$\n</tex-math></inline-formula>. The power consumption <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$x_{bn}=70, E_{bn}^{g}=50$\n</tex-math></inline-formula>. The power consumption satisfaction parameters are <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$\\alpha _{n}=-2, \\beta _{n}=-0.1$\n</tex-math></inline-formula>; the power grid price is <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$\\lambda _{s}=0.4, \\lambda _{b}=1$\n</tex-math></inline-formula>; the relationship between power consumption efficiency and electricity consumption under different electricity prices is shown in <a ref-type=\"fig\" anchor=\"fig3\" class=\"fulltext-link\">Figure 3</a>.</p></li></ol>\n<div class=\"figure figure-full\" id=\"fig3\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9347469/xue3-3057104-large.gif\" data-fig-id=\"fig3\"><img src=\"\" data-src-img=\"/mediastore_new/IEEE/content/media/6287639/9668973/9347469/xue3-3057104-small.gif\" alt=\"FIGURE 3. - Relationship between user\u2019s benefit with power consumption in different price.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 3. </b><fig><p>Relationship between user\u2019s benefit with power consumption in different price.</p></fig></div><p class=\"links\"><a href=\"/document/9347469/figures\" class=\"all\">Show All</a></p></div></p><p>It can be seen from the figure that when the cluster selling price increases, the optimal power consumption of power selling users decreases and its power consumption benefit increases; when the cluster purchase price decreases, the optimal power consumption of power purchasing users increases, and its benefit also increases.</p></div><div class=\"section_2\" id=\"sec2c\"><h3>C. The Profit Model of Cluster Operator</h3><p class=\"has-inline-formula\">As the leader of cluster power trading, cluster operator guides users\u2019 electricity consumption behavior by setting internal transaction price, and it is also the settlement center of all users\u2019 income and expenditure. Users who buy electricity <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$n\\in B$\n</tex-math></inline-formula> and sell electricity <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$n\\in S$\n</tex-math></inline-formula>, then the total amount of users who buy and sell electricity in the <i>i-th</i> period is:<disp-formula id=\"deqn12-deqn13\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*} E_{Bi}=&amp;\\sum \\limits _{n\\in B} (x_{ani} -E_{ni}) \\tag{12}\\\\ E_{Si}=&amp;\\sum \\limits _{n\\in S} (E_{ni} -x_{ani})\\tag{13}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*} E_{Bi}=&amp;\\sum \\limits _{n\\in B} (x_{ani} -E_{ni}) \\tag{12}\\\\ E_{Si}=&amp;\\sum \\limits _{n\\in S} (E_{ni} -x_{ani})\\tag{13}\\end{align*}\n</span></span></disp-formula> When <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$E_{Si}&gt;E_{Bi}$\n</tex-math></inline-formula>, the operator sells the remaining electric energy to the grid at the price of <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$\\lambda _{s}$\n</tex-math></inline-formula>; when <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$E_{Si}&lt; E_{Bi}$\n</tex-math></inline-formula>, the operator purchases power from the grid at the price of <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$\\lambda _{b}$\n</tex-math></inline-formula> to meet the load demand of users. In order to maximize the revenue, CO needs to formulate appropriate cluster tariff. At this time, the operator\u2019s revenue can be expressed as follows.<disp-formula id=\"deqn14\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*}&amp;\\hspace {-2pc}R_{i} (p_{bi},p_{si}) \\\\=&amp;\\begin{cases} {p_{bi} E_{Bi} -p_{si} E_{Bi} +\\lambda _{s} (E_{Si} -E_{Bi}),~~E_{Si} &gt;E_{Bi}} \\\\ {p_{bi} E_{Bi} -p_{si} E_{Si} +\\lambda _{b} (E_{Si} -E_{Bi}),~~E_{Si} \\le E_{Bi}} \\\\ \\end{cases}\\tag{14}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*}&amp;\\hspace {-2pc}R_{i} (p_{bi},p_{si}) \\\\=&amp;\\begin{cases} {p_{bi} E_{Bi} -p_{si} E_{Bi} +\\lambda _{s} (E_{Si} -E_{Bi}),~~E_{Si} &gt;E_{Bi}} \\\\ {p_{bi} E_{Bi} -p_{si} E_{Si} +\\lambda _{b} (E_{Si} -E_{Bi}),~~E_{Si} \\le E_{Bi}} \\\\ \\end{cases}\\tag{14}\\end{align*}\n</span></span></disp-formula> The internal price psi and pb are decision variables, and the solution of the optimal cluster price of period i can be expressed as follows.<disp-formula id=\"deqn15\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*} \\begin{cases} {(p_{bio},p_{sio})=\\mathop {\\arg \\max }\\limits _{(p_{bi},p_{si})} R(p_{bi},p_{si})} \\\\ {s.t.~~\\lambda _{\\textrm {s}} \\le p_{si} \\le p_{bi} \\le \\lambda _{b}}\\\\ \\end{cases}\\tag{15}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*} \\begin{cases} {(p_{bio},p_{sio})=\\mathop {\\arg \\max }\\limits _{(p_{bi},p_{si})} R(p_{bi},p_{si})} \\\\ {s.t.~~\\lambda _{\\textrm {s}} \\le p_{si} \\le p_{bi} \\le \\lambda _{b}}\\\\ \\end{cases}\\tag{15}\\end{align*}\n</span></span></disp-formula> The above formula is a nonlinear programming problem, and the optimal cluster price can be solved by using the interior penalty function method <a ref-type=\"bibr\" anchor=\"ref19\" id=\"context_ref_19_2c\" data-range=\"ref19\">[19]</a>.</p></div></div>\n<div class=\"section\" id=\"sec3\"><div class=\"header article-hdr\"><div class=\"kicker\">\n                                SECTION III.</div><h2>Demand Response Model and Solution of Photovoltaic User Group</h2></div><div class=\"section_2\" id=\"sec3a\"><h3>A. Framework of Bilevel Peogramming Model</h3><p class=\"has-inline-formula\">For one cluster operator, N photovoltaic users who can respond to the demand of Stackelberg game. The game rules are as follows: a leader (cluster operator) formulates and publishes its strategy <i>SL</i> (cluster tariff <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$p_{si}$\n</tex-math></inline-formula> and <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$p_{bi}$\n</tex-math></inline-formula>) from its strategic space <i>SL</i> in the <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$i$\n</tex-math></inline-formula> period, and the other N players (PV users) who become followers observe it <i>sl</i> Select its optimal response (power consumption <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$x_{anio}$\n</tex-math></inline-formula> and ensure that <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$x_{ni(min)}\\le x_{anio}\\le x_{ni(max)}$\n</tex-math></inline-formula>).The leader maximizes his own income <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$R_{i}(p_{si}$\n</tex-math></inline-formula>, <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$p_{bi})$\n</tex-math></inline-formula>, and the follower adjusts the electricity consumption according to the cluster electricity price to maximize its own power consumption benefit function <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$U_{ni}(x_{ani})$\n</tex-math></inline-formula>.The cluster price set by operators in the I period is <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$p_{si}$\n</tex-math></inline-formula> and <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$p_{bi}$\n</tex-math></inline-formula>, which satisfies <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$\\lambda _{s}&lt; p_{si}&lt; p_{bi}&lt; \\lambda _{b}$\n</tex-math></inline-formula>.The game process is shown in <a ref-type=\"fig\" anchor=\"fig4\" class=\"fulltext-link\">Figure 4</a>.\n<div class=\"figure figure-full\" id=\"fig4\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9347469/xue4-3057104-large.gif\" data-fig-id=\"fig4\"><img src=\"\" data-src-img=\"/mediastore_new/IEEE/content/media/6287639/9668973/9347469/xue4-3057104-small.gif\" alt=\"FIGURE 4. - Game process flow chart.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 4. </b><fig><p>Game process flow chart.</p></fig></div><p class=\"links\"><a href=\"/document/9347469/figures\" class=\"all\">Show All</a></p></div></p></div><div class=\"section_2\" id=\"sec3b\"><h3>B. Proof and Solution Method of the Unique Existence of Equilbrium Solution</h3><p class=\"has-inline-formula\">If the Stackelberg game is to reach Nash equilibrium solution, the profit of the leader cluster operators and the benefits of the following photovoltaic users should reach the maximum. Theorem 2 in <a ref-type=\"bibr\" anchor=\"ref10\" id=\"context_ref_10_3b\" data-range=\"ref10\">[10]</a> and <a ref-type=\"theorem\" anchor=\"theorem1\" class=\"fulltext-link\">Theorem 1</a> in <a ref-type=\"bibr\" anchor=\"ref11\" id=\"context_ref_11_3b\" data-range=\"ref11\">[11]</a> prove in detail that the corresponding optimal cluster electricity prices <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$p_{sio}$\n</tex-math></inline-formula> and <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$p_{bio}$\n</tex-math></inline-formula> exist and are unique when the operator\u2019s income is maximum. Using the interior penalty function method to solve <a ref-type=\"disp-formula\" anchor=\"deqn15\" href=\"#deqn15\" class=\"fulltext-link\">equation (15)</a>, the optimal cluster price can be obtained. When the internal optimal electricity price is determined, let <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">${U_{ni}}^{\\prime }(x_{ani})=0$\n</tex-math></inline-formula>, use the fzero function of MATLAB software to solve the ideal optimal electricity consumption <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$x_{nio}$\n</tex-math></inline-formula>, and then according to the user\u2019s power consumption constraints, determine the only optimal electricity consumption <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$x_{anio}$\n</tex-math></inline-formula> of user <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$n$\n</tex-math></inline-formula> in the <i>i-th</i> period, so as to maximize the benefits of users. At this time, Stackelberg game reaches Nash equilibrium.</p></div><div class=\"section_2\" id=\"sec3c\"><h3>C. Demand Response Process of Photovoltaic User</h3><p>The demand response process, that is, the optimal pricing process of photovoltaic user group, is shown in <a ref-type=\"fig\" anchor=\"fig5\" class=\"fulltext-link\">Figure 5</a>.\n<div class=\"figure figure-full\" id=\"fig5\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9347469/xue5-3057104-large.gif\" data-fig-id=\"fig5\"><img src=\"\" data-src-img=\"/mediastore_new/IEEE/content/media/6287639/9668973/9347469/xue5-3057104-small.gif\" alt=\"FIGURE 5. - Game process flow chart.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 5. </b><fig><p>Game process flow chart.</p></fig></div><p class=\"links\"><a href=\"/document/9347469/figures\" class=\"all\">Show All</a></p></div></p><p class=\"has-inline-formula\">Detailed description is as follows: \u2460 In the <i>i-</i> 1 time period, the electricity consumption <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$x_{ni}$\n</tex-math></inline-formula> and photovoltaic power generation <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$E_{ni}$\n</tex-math></inline-formula> of each user in the next time period <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$i$\n</tex-math></inline-formula> are predicted, and they are determined as user types according to the net power. Substituting the optimal power consumption xnio when photovoltaic users trade with the power grid, the power consumption satisfaction parameters <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$\\alpha _{ni}$\n</tex-math></inline-formula>, <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$\\beta _{ni}$\n</tex-math></inline-formula> of users at the <i>i-th</i> moment and the power grid price <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$\\lambda _{s}$\n</tex-math></inline-formula>, <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$\\lambda _{b}$\n</tex-math></inline-formula> into formula <a ref-type=\"disp-formula\" anchor=\"deqn7\" href=\"#deqn7\" class=\"fulltext-link\">(7)</a>, and calculating the utility parameter <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$K_{ni}$\n</tex-math></inline-formula> of the next optimization section. \u2461 Each user sends information such as <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$E_{ni}, K_{ni}, \\alpha _{ni}, \\beta _{ni}, x_{ni}(min), x_{ni}(max)$\n</tex-math></inline-formula> and the role of participating in the transaction to the operator. \u2462 Operators can get the optimal internal electricity price (<inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$p_{sio}$\n</tex-math></inline-formula>, <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$p_{bio}$\n</tex-math></inline-formula>) that can maximize their profits according to user information and formula <a ref-type=\"disp-formula\" anchor=\"deqn15\" href=\"#deqn15\" class=\"fulltext-link\">(15)</a>. \u2463 Each user determines the optimal electricity consumption <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$x_{anio}$\n</tex-math></inline-formula> that maximizes its utility according to the cluster electricity price (<inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$p_{sio}$\n</tex-math></inline-formula>, <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$p_{bio}$\n</tex-math></inline-formula>) issued by the operator, and the demand response process in the next optimization period is completed. From the previous part, it can be seen that adjusting the electricity load in response to the user\u2019s demand will not change their participation role.</p></div></div>\n<div class=\"section\" id=\"sec4\"><div class=\"header article-hdr\"><div class=\"kicker\">\n                                SECTION IV.</div><h2>User Importance Evaluation and Raking Based on TOPSIS</h2></div><div class=\"section_2\" id=\"sec4a\"><h3>A. Defining Evaluation Criteria</h3><p>From the user\u2019s point of view, the main benefit of photovoltaic users is the power consumption cost saved by their own use. When the users have surplus electricity to share with the users in the group, it can reduce the power purchase price within the group and save the power consumption cost of the power shortage users. Moreover, users are more willing to join the photovoltaic user group with relatively abundant surplus power, so the users who share more energy will be loved by other users.</p><p>From the operator\u2019s point of view, the revenue of operators is related to the mutual use of electricity by producers and sellers. Whether users are surplus or short of electricity, they contribute to its income. The greater the contribution value is, the more important it is.</p><p>From the perspective of power grid, the larger the total installed capacity of the whole photovoltaic user group, the more attention will be paid by the power grid, and the greater the installed capacity, the greater the potential of providing electric energy. Therefore, the installed capacity of users is also a factor to be considered in evaluating the importance of users. Therefore, the criteria for evaluating the importance of users are as follows: a) shared photovoltaic energy; b) contribution to operators\u2019 revenue; c) installed capacity of users.</p><div class=\"section_2\" id=\"sec4a1\"><h4>1) Calculation of Shared Photovoltaic Energy</h4><p class=\"has-inline-formula\">The power sharing behavior of residual power users is the fundamental reason for operators and other users who are short of electricity. The power shared by user <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$i$\n</tex-math></inline-formula> in a calculation cycle <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$T$\n</tex-math></inline-formula> is <disp-formula id=\"deqn16\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} H_{i} =\\Delta t\\sum \\limits _{k=1}^{m} {a_{i}^{k} D_{i} (k)}\\tag{16}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} H_{i} =\\Delta t\\sum \\limits _{k=1}^{m} {a_{i}^{k} D_{i} (k)}\\tag{16}\\end{equation*}\n</span></span></disp-formula></p></div><div class=\"section_2\" id=\"sec4a2\"><h4>2) Calculation of Users\u2019 Contribution to Operators\u2019 Revenue</h4><p class=\"has-inline-formula\">The photovoltaic user group led by the operator is essentially the operator alliance photovoltaic users and then trade with the grid, which is equivalent to the alliance game, only increases the alliance revenue <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$\\Delta v$\n</tex-math></inline-formula>. Most of them are obtained by operators, and other photovoltaic users get the remaining part of the increased revenue. The contribution value of user <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$i$\n</tex-math></inline-formula> to the operator\u2019s revenue is the user <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$i^{\\prime }s$\n</tex-math></inline-formula> contribution value in the alliance game minus the revenue in the cluster. The contribution value of user <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$i$\n</tex-math></inline-formula> in a calculation cycle is calculated as follows.<disp-formula id=\"deqn17\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} C_{i} =v_{i} -P_{i}^{c}\\tag{17}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} C_{i} =v_{i} -P_{i}^{c}\\tag{17}\\end{equation*}\n</span></span></disp-formula></p></div><div class=\"section_2\" id=\"sec4a3\"><h4>3) Installed Capacity of Users</h4><p class=\"has-inline-formula\">The larger the installed capacity of the whole PV group is, the more attention the grid attaches to the PV user group. Therefore, the installed capacity <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$F_{i}$\n</tex-math></inline-formula> of user <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$i$\n</tex-math></inline-formula> should also be considered in order to rank the importance of users in the cluster.</p></div></div><div class=\"section_2\" id=\"sec4b\"><h3>B. Priority and Weight Calculation of Evaluation Criteria</h3><p>Power sharing can not only save the cost of electricity purchase, but also increase the profit of cluster operator. In addition, in order to encourage users to share electric energy, this paper puts the evaluation index A in the first place. Indicator B can not only reflect the profit contribution of residual power users to the cluster operator, but also indicate the revenue contribution of power shortage users to the cluster operator. Therefore, the evaluation index B is ranked second and the evaluation index C is ranked third. The ranking results are as follows: 1) sharing photovoltaic energy; 2) contribution to operators\u2019 revenue; 3) installed capacity of users.</p><p class=\"has-inline-formula\">The higher the ranking of evaluation indicators, the greater the weight coefficient. According to the \u201cweights from ranks\u201d method, the weight coefficient of evaluation criteria <a ref-type=\"bibr\" anchor=\"ref20\" id=\"context_ref_20_4b\" data-range=\"ref20\">[20]</a> was calculated.<disp-formula id=\"deqn18\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} \\lambda _{j} =\\frac {f-j+1}{\\sum \\limits _{j=1}^{f} {(f-j+1)}}\\tag{18}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} \\lambda _{j} =\\frac {f-j+1}{\\sum \\limits _{j=1}^{f} {(f-j+1)}}\\tag{18}\\end{equation*}\n</span></span></disp-formula>In the formula, <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$f$\n</tex-math></inline-formula> represents the total number of evaluation criteria, and <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$\\lambda _{j}$\n</tex-math></inline-formula> represents the weight coefficient of the <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$j$\n</tex-math></inline-formula> evaluation criteria.</p></div><div class=\"section_2\" id=\"sec4c\"><h3>C. User Importance Evaluation and Ranking Based on TOPSIS Method</h3><p>The basic principle of TOPSIS evaluation method (the idea of approaching the ideal solution): Based on the normalized original matrix, the optimal scheme and the worst scheme (expressed by the optimal vector and the most column vector respectively) in the finite scheme are found out, and then the distance between the evaluation object and the optimal scheme and the worst scheme is calculated respectively to obtain the relative closeness between the evaluation object and the optimal scheme, This is the basis of evaluation.</p><p class=\"has-inline-formula\">This paper defines the value of user <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$i$\n</tex-math></inline-formula> under <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$j\\,\\,(j=1,2,3.)$\n</tex-math></inline-formula><disp-formula id=\"deqn19\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*} y_{ij} =\\begin{cases} H_{i} &amp; {j=1}\\\\ C_{i} &amp; {j=2}\\\\ F_{i} &amp; {j=3} \\end{cases}\\tag{19}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*} y_{ij} =\\begin{cases} H_{i} &amp; {j=1}\\\\ C_{i} &amp; {j=2}\\\\ F_{i} &amp; {j=3} \\end{cases}\\tag{19}\\end{align*}\n</span></span></disp-formula> After preprocessing the user\u2019s data <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$y_{ij}$\n</tex-math></inline-formula> by linear transformation, the normalized decision matrix Z is obtained.<disp-formula id=\"deqn20\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} z_{ij} =y_{ij} /y_{j}^{\\max }\\tag{20}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} z_{ij} =y_{ij} /y_{j}^{\\max }\\tag{20}\\end{equation*}\n</span></span></disp-formula> In the formula, <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$y_{i}^{\\max } $\n</tex-math></inline-formula> represents the maximum value of all users corresponding to the <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$j$\n</tex-math></inline-formula> standard.</p><p class=\"has-inline-formula\">The weighted normal matrix X is obtained by multiplying Z by the weight coefficient.<disp-formula id=\"deqn21\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} x_{ij} =\\lambda _{j} \\cdot z_{ij}\\tag{21}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} x_{ij} =\\lambda _{j} \\cdot z_{ij}\\tag{21}\\end{equation*}\n</span></span></disp-formula> Defining ideal solutions <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$x_{i}^{\\ast }$\n</tex-math></inline-formula> and negative ideal solution <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$x_{i}^{0}$\n</tex-math></inline-formula> by <disp-formula id=\"deqn22-deqn23\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*} x_{j}^{\\ast }=&amp;\\max \\limits _{i} (x_{ij}) \\tag{22}\\\\ x_{j}^{0}=&amp;\\min \\limits _{i} (x_{ij})\\tag{23}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*} x_{j}^{\\ast }=&amp;\\max \\limits _{i} (x_{ij}) \\tag{22}\\\\ x_{j}^{0}=&amp;\\min \\limits _{i} (x_{ij})\\tag{23}\\end{align*}\n</span></span></disp-formula> The distance from user i to ideal user and negative ideal user is calculated.<disp-formula id=\"deqn24-deqn25\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*} d_{i}^{\\ast }=&amp;\\sqrt {\\sum \\limits _{j=1}^{f} {(x_{ij} -x_{j}^{\\ast })^{2}}} \\tag{24}\\\\ d_{i}^{0}=&amp;\\sqrt {\\sum \\limits _{j=1}^{f} {(x_{ij} -x_{j}^{0})^{2}}}\\tag{25}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*} d_{i}^{\\ast }=&amp;\\sqrt {\\sum \\limits _{j=1}^{f} {(x_{ij} -x_{j}^{\\ast })^{2}}} \\tag{24}\\\\ d_{i}^{0}=&amp;\\sqrt {\\sum \\limits _{j=1}^{f} {(x_{ij} -x_{j}^{0})^{2}}}\\tag{25}\\end{align*}\n</span></span></disp-formula> Calculate how close the user is to the ideal user in the cluster.<disp-formula id=\"deqn26\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} C_{i}^{\\ast } =\\frac {d_{i}^{0}}{d_{i}^{0} +d_{i}^{\\ast }}\\tag{26}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} C_{i}^{\\ast } =\\frac {d_{i}^{0}}{d_{i}^{0} +d_{i}^{\\ast }}\\tag{26}\\end{equation*}\n</span></span></disp-formula> Rank the importance of photovoltaic users from big to small by <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$C_{i}^{\\ast } $\n</tex-math></inline-formula>.</p></div></div>\n<div class=\"section\" id=\"sec5\"><div class=\"header article-hdr\"><div class=\"kicker\">\n                                SECTION V.</div><h2>Example Analysis</h2></div><p class=\"has-inline-formula\">Five users with photovoltaic power generation system in a region constitute a photovoltaic user group. They respond to the demand through Stackelberg algorithm under the guidance of cluster operator. When the distributed generation output of the cluster is 0, all the electricity is purchased directly from the grid by the operators <a ref-type=\"bibr\" anchor=\"ref17\" id=\"context_ref_17_5\" data-range=\"ref17\">[17]</a>. At this time, <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$p_{si}=\\lambda _{s}$\n</tex-math></inline-formula>, <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$p_{bi}=\\lambda _{b}$\n</tex-math></inline-formula>.Therefore, this paper only studies the time period of distributed photovoltaic power output. The installed capacity of each user in the photovoltaic user group is shown in <a ref-type=\"table\" anchor=\"table1\" class=\"fulltext-link\">Table 1</a>. The typical solar volt output power curve and the daily load consumption curve of users are shown in <a ref-type=\"fig\" anchor=\"fig6\" class=\"fulltext-link\">figures 6</a> and <a ref-type=\"fig\" anchor=\"fig7\" class=\"fulltext-link\">7</a>.<div class=\"figure figure-full table\" id=\"table1\"><div class=\"figcaption\"><b class=\"title\">TABLE 1 </b>\nPhotovoltaic User Installed Capacity</div><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9347469/xue.t1-3057104-large.gif\"><img src=\"\" data-src-img=\"/mediastore_new/IEEE/content/media/6287639/9668973/9347469/xue.t1-3057104-small.gif\" alt=\"Table 1- &#10;Photovoltaic User Installed Capacity\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div></div>\n<div class=\"figure figure-full\" id=\"fig6\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9347469/xue6-3057104-large.gif\" data-fig-id=\"fig6\"><img src=\"\" data-src-img=\"/mediastore_new/IEEE/content/media/6287639/9668973/9347469/xue6-3057104-small.gif\" alt=\"FIGURE 6. - Prosumer\u2019 photovoltaic output power in each period.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 6. </b><fig><p>Prosumer\u2019 photovoltaic output power in each period.</p></fig></div><p class=\"links\"><a href=\"/document/9347469/figures\" class=\"all\">Show All</a></p></div>\n<div class=\"figure figure-full\" id=\"fig7\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9347469/xue7-3057104-large.gif\" data-fig-id=\"fig7\"><img src=\"\" data-src-img=\"/mediastore_new/IEEE/content/media/6287639/9668973/9347469/xue7-3057104-small.gif\" alt=\"FIGURE 7. - Prosumer\u2019 power consumption in each period.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 7. </b><fig><p>Prosumer\u2019 power consumption in each period.</p></fig></div><p class=\"links\"><a href=\"/document/9347469/figures\" class=\"all\">Show All</a></p></div></p><p class=\"has-inline-formula\">According to the distributed photovoltaic grid price in most regions of China, the benchmark grid price of coal-fired units is 0.4 yuan /(kW.h) for parameter <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$\\lambda _{s}$\n</tex-math></inline-formula>, and <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$\\lambda _{b}$\n</tex-math></inline-formula> is the commercial electricity price, which is 1.0 yuan /(kW.h) Users\u2019 electricity satisfaction parameters <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$\\alpha _{ni}$\n</tex-math></inline-formula> and <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$\\beta _{ni}$\n</tex-math></inline-formula> can take any value under the condition of satisfaction according to the requirements of users in each time period. For the convenience of calculation, here we uniformly take <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$\\alpha _{ni}=-2, \\beta _{ni}=-0.1$\n</tex-math></inline-formula>. It is assumed that the requirements of five users on electricity consumption satisfaction are the same in each period. Due to the need to meet the profit demand of operators and power grid in real life, as well as the power supply line demand of power load, the supplementary conditions of simulation are as follows. <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$\\lambda _{s}&lt; p_{si}&lt; p_{bi}&lt; \\lambda _{b}$\n</tex-math></inline-formula> and <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$x_{ni(min)}\\le x_{ani}\\le x_{ni(max)}$\n</tex-math></inline-formula>.</p><div class=\"section_2\" id=\"sec5a\"><h3>A. User Importance Evaluation and Ranking Rationality Analysis</h3><p>The shared photovoltaic energy in the user calculation period T is as follows.</p><p><a ref-type=\"table\" anchor=\"table3\" class=\"fulltext-link\">Table 3</a> and <a ref-type=\"table\" anchor=\"table4\" class=\"fulltext-link\">table 4</a> show the user\u2019s income within cycle T under the cooperative alliance mode and the internal tariff mode, respectively.<div class=\"figure figure-full table\" id=\"table2\"><div class=\"figcaption\"><b class=\"title\">TABLE 2 </b>\nThe Amount of Electricity Shared by PV Users</div><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9347469/xue.t2-3057104-large.gif\"><img src=\"\" data-src-img=\"/mediastore_new/IEEE/content/media/6287639/9668973/9347469/xue.t2-3057104-small.gif\" alt=\"Table 2- &#10;The Amount of Electricity Shared by PV Users\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div></div><div class=\"figure figure-full table\" id=\"table3\"><div class=\"figcaption\"><b class=\"title\">TABLE 3 </b>\nBenefits in the Cooperative Alliance Model</div><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9347469/xue.t3-3057104-large.gif\"><img src=\"\" data-src-img=\"/mediastore_new/IEEE/content/media/6287639/9668973/9347469/xue.t3-3057104-small.gif\" alt=\"Table 3- &#10;Benefits in the Cooperative Alliance Model\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div></div><div class=\"figure figure-full table\" id=\"table4\"><div class=\"figcaption\"><b class=\"title\">TABLE 4 </b>\nBenefits in the Internal Electricity Price Model</div><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9347469/xue.t4-3057104-large.gif\"><img src=\"\" data-src-img=\"/mediastore_new/IEEE/content/media/6287639/9668973/9347469/xue.t4-3057104-small.gif\" alt=\"Table 4- &#10;Benefits in the Internal Electricity Price Model\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div></div></p><p>Based on the data in <a ref-type=\"table\" anchor=\"table3\" class=\"fulltext-link\">tables 3</a> and <a ref-type=\"table\" anchor=\"table4\" class=\"fulltext-link\">4</a>, the revenue of users to operators is calculated according to formula <a ref-type=\"disp-formula\" anchor=\"deqn17\" href=\"#deqn17\" class=\"fulltext-link\">(17)</a>, as shown in <a ref-type=\"table\" anchor=\"table5\" class=\"fulltext-link\">Table 5</a>.<div class=\"figure figure-full table\" id=\"table5\"><div class=\"figcaption\"><b class=\"title\">TABLE 5 </b>\nPhotovoltaic Users\u2019 Contribution to Cluster Operator Revenue</div><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9347469/xue.t5-3057104-large.gif\"><img src=\"\" data-src-img=\"/mediastore_new/IEEE/content/media/6287639/9668973/9347469/xue.t5-3057104-small.gif\" alt=\"Table 5- &#10;Photovoltaic Users\u2019 Contribution to Cluster Operator Revenue\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div></div></p><p>When the internal electricity price is implemented, the revenue of cluster operator in calculation period T is 473.07 yuan, and the sum of users\u2019 contribution to cluster operator\u2019s revenue is equal to that of cluster operator, which verifies the correctness of calculation of contribution value.</p><p class=\"has-inline-formula\">According to the data in <a ref-type=\"table\" anchor=\"table1\" class=\"fulltext-link\">Tables 1</a> to <a ref-type=\"table\" anchor=\"table2\" class=\"fulltext-link\"/><a ref-type=\"table\" anchor=\"table3\" class=\"fulltext-link\">3</a> and <a ref-type=\"disp-formula\" anchor=\"deqn19\" href=\"#deqn19\" class=\"fulltext-link\">equations (19)</a>\u2013\u200b<a ref-type=\"disp-formula\" anchor=\"deqn20\" href=\"#deqn20\" class=\"fulltext-link\">(20)</a>, the normative decision matrix Z is calculated <disp-formula id=\"\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*} Z=\\left [{ {{\\begin{matrix} {0.6016} &amp;{0.4355} &amp; 1 \\\\ 1 &amp;{0.7909} &amp;{0.9474} \\\\ {0.5579} &amp;{0.4044} &amp;{0.6404} \\\\ {0.0272} &amp;{0.1947} &amp;{0.4649} \\\\ 0 &amp;1 &amp;{0.5263} \\\\ \\end{matrix}}} }\\right]\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*} Z=\\left [{ {{\\begin{matrix} {0.6016} &amp;{0.4355} &amp; 1 \\\\ 1 &amp;{0.7909} &amp;{0.9474} \\\\ {0.5579} &amp;{0.4044} &amp;{0.6404} \\\\ {0.0272} &amp;{0.1947} &amp;{0.4649} \\\\ 0 &amp;1 &amp;{0.5263} \\\\ \\end{matrix}}} }\\right]\\end{align*}\n</span></span></disp-formula> According to formula <a ref-type=\"disp-formula\" anchor=\"deqn18\" href=\"#deqn18\" class=\"fulltext-link\">(18)</a>, the weight coefficients of evaluation criteria are calculated as follows: <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$\\lambda _{1}=0.5, \\lambda _{2}=0.3333\\,\\, \\text {and}\\,\\,\\lambda _{3}=0.1667$\n</tex-math></inline-formula>. According to formula <a ref-type=\"disp-formula\" anchor=\"deqn21\" href=\"#deqn21\" class=\"fulltext-link\">(21)</a>, the weighted gauge matrix X is obtained.<disp-formula id=\"\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*} X=\\left [{ {{\\begin{matrix} {0.3008} &amp;{0.1452} &amp;{0.1667} \\\\ {0.5} &amp;{0.2636} &amp;{0.1579} \\\\ {0.2789} &amp;{0.1348} &amp;{0.1068} \\\\ {0.0136} &amp;{0.0649} &amp;{0.0775} \\\\ 0 &amp;{0.3333} &amp;{0.0877} \\\\ \\end{matrix}}} }\\right]\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*} X=\\left [{ {{\\begin{matrix} {0.3008} &amp;{0.1452} &amp;{0.1667} \\\\ {0.5} &amp;{0.2636} &amp;{0.1579} \\\\ {0.2789} &amp;{0.1348} &amp;{0.1068} \\\\ {0.0136} &amp;{0.0649} &amp;{0.0775} \\\\ 0 &amp;{0.3333} &amp;{0.0877} \\\\ \\end{matrix}}} }\\right]\\end{align*}\n</span></span></disp-formula> The value of the closeness <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$C_{i}^{\\ast }$\n</tex-math></inline-formula> between the user and the ideal user in the photovoltaic group calculated by formula <a ref-type=\"disp-formula\" anchor=\"deqn22-deqn23\" href=\"#deqn22-deqn23\" class=\"fulltext-link\">(22)</a><a ref-type=\"disp-formula\" anchor=\"deqn24-deqn25\" href=\"#deqn24-deqn25\" class=\"fulltext-link\"/>\u2013\u200b<a ref-type=\"disp-formula\" anchor=\"deqn26\" href=\"#deqn26\" class=\"fulltext-link\">(26)</a> is shown in <a ref-type=\"table\" anchor=\"table6\" class=\"fulltext-link\">Table 6</a>.<div class=\"figure figure-full table\" id=\"table6\"><div class=\"figcaption\"><b class=\"title\">TABLE 6 </b>\nUser Proximity to Ideal Users in the PV Cluster</div><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9347469/xue.t6-3057104-large.gif\"><img src=\"\" data-src-img=\"/mediastore_new/IEEE/content/media/6287639/9668973/9347469/xue.t6-3057104-small.gif\" alt=\"Table 6- &#10;User Proximity to Ideal Users in the PV Cluster\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div></div></p><p>According to <a ref-type=\"table\" anchor=\"table1\" class=\"fulltext-link\">table 1</a>, <a ref-type=\"table\" anchor=\"table2\" class=\"fulltext-link\">table 2</a> and <a ref-type=\"table\" anchor=\"table5\" class=\"fulltext-link\">table 5</a>, the installed capacity of user 1 is the largest and that of user 4 is the smallest. User 5 has the largest contribution to the operator\u2019s revenue, and user 4 has the smallest contribution to the operator\u2019s revenue. User 2 shares the most electric energy, while user 5 shares the least and 0 energy. It needs to purchase electricity from the cluster operator at each time. There is no research on the importance evaluation and ranking of users in the photovoltaic user group in the existing literature, so this paper assumes that the importance evaluation and ranking is based on the single attribute of users. Photovoltaic user group is operated under the management of operators, assuming that operators start from their own revenue and rank according to the contribution value of users to their own revenue. Compared with the comprehensive evaluation method proposed in this paper, the comparison of user ranking results is shown in <a ref-type=\"fig\" anchor=\"fig8\" class=\"fulltext-link\">Figure 8</a>.\n<div class=\"figure figure-full\" id=\"fig8\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9347469/xue8-3057104-large.gif\" data-fig-id=\"fig8\"><img src=\"\" data-src-img=\"/mediastore_new/IEEE/content/media/6287639/9668973/9347469/xue8-3057104-small.gif\" alt=\"FIGURE 8. - User importance ranking.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 8. </b><fig><p>User importance ranking.</p></fig></div><p class=\"links\"><a href=\"/document/9347469/figures\" class=\"all\">Show All</a></p></div></p><p>As can be seen from the above figure, the ranking results of user 4 are the same under the two evaluation methods. Other users rank differently under the two evaluation methods. User 5 ranks first in the evaluation method based on contribution value, but ranks fourth in the comprehensive evaluation method. The ranking results of the two evaluation methods are quite different. Based on the analysis of user 5\u2019s electricity consumption behavior, it does not share energy with other users during the day\u2019s operation of photovoltaic user group. From the original intention of establishing photovoltaic user group, encouraging users to share electricity has poor performance. In the comprehensive evaluation method, users are encouraged to share electric energy, and their ability to absorb excess photovoltaic energy and installed capacity are also considered. Therefore, the ranking under the comprehensive evaluation is more reasonable and fair.</p></div><div class=\"section_2\" id=\"sec5b\"><h3>B. Analysis of Power Consumption Adjustment Rate of Users</h3><p class=\"has-inline-formula\">The operator formulates the internal price to maximize its own revenue. The user carries out demand response according to the cluster electricity price to maximize its comprehensive benefit. The calculation formula of the electricity consumption adjustment rate of user <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$n$\n</tex-math></inline-formula> in the <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$i$\n</tex-math></inline-formula> period is as follows:<disp-formula id=\"deqn27\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} \\delta _{ni} =(x_{anio} -x_{ni})/x_{ni} \\times 100\\%\\tag{27}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} \\delta _{ni} =(x_{anio} -x_{ni})/x_{ni} \\times 100\\%\\tag{27}\\end{equation*}\n</span></span></disp-formula></p><p class=\"has-inline-formula\">In this paper, The comprehensive benefit model (<inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$\\alpha _{ni}=-2, \\beta _{ni}=-0.1$\n</tex-math></inline-formula>) considering the satisfaction degree of electricity consumption and the original benefit model (<inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$\\alpha =\\beta =0$\n</tex-math></inline-formula>) without introducing the satisfaction degree function are used to calculate respectively. The adjustment rate of electricity consumption in each time period after each user\u2019s demand response is shown in <a ref-type=\"fig\" anchor=\"fig9\" class=\"fulltext-link\">Figure 9</a>\u2013\u200b<a ref-type=\"fig\" anchor=\"fig10\" class=\"fulltext-link\">10</a>.\n<div class=\"figure figure-full\" id=\"fig9\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9347469/xue9-3057104-large.gif\" data-fig-id=\"fig9\"><img src=\"\" data-src-img=\"/mediastore_new/IEEE/content/media/6287639/9668973/9347469/xue9-3057104-small.gif\" alt=\"FIGURE 9. - Electricity adjustment rate considering electricity satisfaction.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 9. </b><fig><p>Electricity adjustment rate considering electricity satisfaction.</p></fig></div><p class=\"links\"><a href=\"/document/9347469/figures\" class=\"all\">Show All</a></p></div>\n<div class=\"figure figure-full\" id=\"fig10\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9347469/xue10-3057104-large.gif\" data-fig-id=\"fig10\"><img src=\"\" data-src-img=\"/mediastore_new/IEEE/content/media/6287639/9668973/9347469/xue10-3057104-small.gif\" alt=\"FIGURE 10. - Original electricity adjustment rate.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 10. </b><fig><p>Original electricity adjustment rate.</p></fig></div><p class=\"links\"><a href=\"/document/9347469/figures\" class=\"all\">Show All</a></p></div></p><p>According to the figure, the maximum load adjustment rates of users 1, 2 and 3 all occur at the time of selling electricity, and the maximum load adjustment rates of users 4 and 5 occur at the time of buying electricity. The five users are reduced by 49%, 54%, 50%, 96% and 68%, respectively. Compared with the above figure, the new power consumption benefit model can effectively reduce their own power consumption adjustment rate, thus ensuring users\u2019 power consumption comfort.</p><p class=\"has-inline-formula\">It is assumed that users in the group use the same satisfaction parameters in one day.<inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$\\alpha =\\beta =0$\n</tex-math></inline-formula> means that the user does not consider the power consumption satisfaction, and the other three groups of satisfaction parameters meet the requirements of <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$\\alpha \\beta =0.2$\n</tex-math></inline-formula>. In this way, the utility coefficient of electricity consumption is the same when the satisfaction parameters of users are different. The absolute value of maximum adjustment rate of users under different satisfaction parameters is shown in <a ref-type=\"table\" anchor=\"table7\" class=\"fulltext-link\">Table 7</a>.<div class=\"figure figure-full table\" id=\"table7\"><div class=\"figcaption\"><b class=\"title\">TABLE 7 </b>\nComparison of the Maximum Power Consumption Adjustment Rate of Users</div><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9347469/xue.t7-3057104-large.gif\"><img src=\"\" data-src-img=\"/mediastore_new/IEEE/content/media/6287639/9668973/9347469/xue.t7-3057104-small.gif\" alt=\"Table 7- &#10;Comparison of the Maximum Power Consumption Adjustment Rate of Users\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div></div></p><p class=\"has-inline-formula\">It can be seen from <a ref-type=\"table\" anchor=\"table1\" class=\"fulltext-link\">table 1</a> that the smaller the customer satisfaction parameter <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$\\alpha $\n</tex-math></inline-formula>, the lower the absolute value of electricity adjustment rate of residual power users and power shortage users. The smaller the <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$\\alpha $\n</tex-math></inline-formula> of the residual power users, it indicates that the consumers have high requirements for electricity consumption and will not easily reduce their own power consumption. The smaller the <inline-formula class=\"inline-formula\"><tex-math notation=\"LaTeX\">$\\alpha $\n</tex-math></inline-formula> of the power shortage users is, the higher the power consumption will not significantly improve the power consumption comfort, so they are not willing to use more electricity.</p></div><div class=\"section_2\" id=\"sec5c\"><h3>C. Operator Profit Comparison</h3><p>In order to maximize the profit, operators will adjust the internal price. The internal price of the typical day is shown in <a ref-type=\"fig\" anchor=\"fig11\" class=\"fulltext-link\">Figure 11</a> below.\n<div class=\"figure figure-full\" id=\"fig11\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9347469/xue11-3057104-large.gif\" data-fig-id=\"fig11\"><img src=\"\" data-src-img=\"/mediastore_new/IEEE/content/media/6287639/9668973/9347469/xue11-3057104-small.gif\" alt=\"FIGURE 11. - Photovoltaic user group internal price.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 11. </b><fig><p>Photovoltaic user group internal price.</p></fig></div><p class=\"links\"><a href=\"/document/9347469/figures\" class=\"all\">Show All</a></p></div></p><p>It can be seen from the figure that after taking into account the user\u2019s satisfaction with electricity consumption, the price of electricity purchased by power consumers through operators is higher than that before. The price of electricity sales is lower than the original internal price except 12:00.</p><p>According to the above analysis, it can be seen that the income of cluster operator is increased; secondly, compared with the non-cluster mode, users can reduce the electricity consumption cost of power consumers and improve the electricity sales income of residual power users, and the comprehensive benefit of electricity consumption of users is increased. Finally, compared with the electricity consumption benefit model without considering the satisfaction degree, the model users can effectively reduce the adjustment rate of electricity consumption, and implement the optimal power consumption according to the different requirements of different users.</p></div></div>\n<div class=\"section\" id=\"sec6\"><div class=\"header article-hdr\"><div class=\"kicker\">\n                                SECTION VI.</div><h2>Conclusion</h2></div><p>To solve the problem of high electricity consumption adjustment rate when the PV users respond to the cluster electricity price demand, the paper introduces the electricity consumption satisfaction function and proposes an optimal pricing model for PV users using the master-slave game. Moreover, to promote the stability and development of photovoltaic user groups, the paper analyzes the nature of operators\u2019 revenue, and uses cooperative game theory to calculate the contribution value of users in the group to operators\u2019 revenue. From the three aspects: users, operators, and power grid, the importance evaluation index of users is defined, and a strategy for evaluating the importance using TOPSIS method is proposed with the aim of completing the comprehensive ranking of producers and sellers. The proposed model revealed that, comprehensive ranking of users is more fair and reasonable, which can effectively encourage users to install household photovoltaic equipment and share electricity, hence promoting the virtuous circle of household photovoltaic industry. On electricity consumption adjustment rate, the proposed model showed that the electricity sellers are reduced by 50%, and electricity buyers are more than 50%, which effectively guarantees the user\u2019s electricity experience and is more suitable in real life. It can be implemented according to different requirements of different users. On Optimal electricity consumption aspect, the electricity utility showed that, cluster mode is beneficial where by it reduces the electricity consumption cost of users, improves the electricity sales income of surplus users, and increases the comprehensive users\u2019 electricity consumption. In terms of operators\u2019 revenue, it was proven from the price comparison chart that there is increase in profitability.</p><p>The developed example verifies the superiority of optimized pricing model, the effectiveness of the user benefit model, the feasibility of the calculation method of the contribution value, and the rationality of the evaluation method. Compared with the existing mode, the electricity price calculation mode and the ranking strategy of users in this model are more reasonable, and its operation mode can more powerfully encourage users to generate electricity, stimulate the development of household photovoltaic, increase the installed capacity, and further move towards \u201ccarbon neutrality\u201d.</p><p>In conclusion, the model proposed in this paper has a strong practical reference value in the future of the ever-expanding household photovoltaic industry. However, the proposed model assumes that the satisfaction parameters of users in the group are similar. This is not the case in the real life, where different families have different satisfaction parameters for electricity consumption at varied time period. Therefore, the study recommends further study on the influence of power consumption satisfaction parameters on cluster economic operation model.</p></div>\n</div></div></response>\n"
}